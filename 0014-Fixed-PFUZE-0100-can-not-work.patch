From 5ff8e96982dafc52d4c094b748bc8443dfd44b7d Mon Sep 17 00:00:00 2001
From: Bingru Tsai <ben_tsai@avalue.com.tw>
Date: Thu, 30 Apr 2015 17:14:50 +0800
Subject: [PATCH 14/20] Fixed PFUZE-0100 can not work.

---
 kernel_imx/arch/arm/configs/imx6_smarc_p_android_defconfig | 3 ++-
 kernel_imx/arch/arm/mach-mx6/Kconfig                       | 2 +-
 kernel_imx/arch/arm/mach-mx6/smarc/rev_sa01.c              | 2 ++
 3 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/kernel_imx/arch/arm/configs/imx6_smarc_p_android_defconfig b/kernel_imx/arch/arm/configs/imx6_smarc_p_android_defconfig
index 837f0f2..f75a914 100644
--- a/kernel_imx/arch/arm/configs/imx6_smarc_p_android_defconfig
+++ b/kernel_imx/arch/arm/configs/imx6_smarc_p_android_defconfig
@@ -335,7 +335,8 @@ CONFIG_MACH_MX6Q_SABRELITE=y
 CONFIG_MACH_MX6Q_SABRESD=y
 CONFIG_MACH_MX6Q_SABREAUTO=y
 CONFIG_MACH_MX6Q_HDMIDONGLE=y
-CONFIG_MACH_MX6_SMARC=y
+# CONFIG_MACH_MX6_SMARC is not set
+CONFIG_MACH_MX6_SMARC_P=y
 
 #
 # MX6 Options:
diff --git a/kernel_imx/arch/arm/mach-mx6/Kconfig b/kernel_imx/arch/arm/mach-mx6/Kconfig
index 2232d75..c7178d1 100644
--- a/kernel_imx/arch/arm/mach-mx6/Kconfig
+++ b/kernel_imx/arch/arm/mach-mx6/Kconfig
@@ -333,7 +333,7 @@ config MACH_MX6_SMARC
 	  configurations for the board and its peripherals.
 
 config MACH_MX6_SMARC_P
-	bool "Support i.MX6 SMARC platform"
+	bool "Support i.MX6 SMARC platform with PFUZE-0100"
 	depends on SMARC
 	select ARCH_MX6Q
 	select SOC_IMX6Q
diff --git a/kernel_imx/arch/arm/mach-mx6/smarc/rev_sa01.c b/kernel_imx/arch/arm/mach-mx6/smarc/rev_sa01.c
index 93ab929..5461db1 100644
--- a/kernel_imx/arch/arm/mach-mx6/smarc/rev_sa01.c
+++ b/kernel_imx/arch/arm/mach-mx6/smarc/rev_sa01.c
@@ -373,12 +373,14 @@ static struct wm8962_pdata wm8962_config_data = {
 };
 
 static struct regulator_consumer_supply smarc_vwm8962_consumers[] = {
+	#ifdef	CONFIG_MACH_MX6_SMARC
 	REGULATOR_SUPPLY("DCVDD", "0-001a"),
 	REGULATOR_SUPPLY("DBVDD", "0-001a"),
 	REGULATOR_SUPPLY("AVDD", "0-001a"),
 	REGULATOR_SUPPLY("CPVDD", "0-001a"),
 	REGULATOR_SUPPLY("MICVDD", "0-001a"),
 	REGULATOR_SUPPLY("PLLVDD", "0-001a"),
+	#endif
 	REGULATOR_SUPPLY("SPKVDD1", "0-001a"),
 	REGULATOR_SUPPLY("SPKVDD2", "0-001a"),
 };
-- 
1.9.1

